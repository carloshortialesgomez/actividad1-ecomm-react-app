// Criterio: Página de checkout (cuarta ruta)
import React, { useState } from 'react';
import { useCart } from '../context/CartContext.js';
import '../styles/pages/CheckoutPage.css';

const CheckoutPage = () => {
  const { cartItems, getCartTotal, clearCart } = useCart();
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    address: '',
    city: '',
    cardNumber: '',
    expiryDate: '',
    cvv: ''
  });

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData({
      ...formData,
      [name]: value
    });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (cartItems.length === 0) {
      alert('Tu carrito está vacío');
      return;
    }
    
    alert('¡Compra realizada con éxito!');
    clearCart();
    // Redirigir a inicio
    window.location.href = '/';
  };

  if (cartItems.length === 0) {
    return (
      <div className="checkout-page checkout-page--empty">
        <h2>No hay productos en el carrito</h2>
        <a href="/" className="checkout-page__continue">
          Continuar comprando
        </a>
      </div>
    );
  }

  return (
    <div className="checkout-page">
      <h1 className="checkout-page__title">Finalizar Compra</h1>
      
      <div className="checkout-page__content">
        <form onSubmit={handleSubmit} className="checkout-page__form">
          <div className="checkout-page__section">
            <h3>Información de Envío</h3>
            
            <div className="checkout-page__form-group">
              <label htmlFor="name">Nombre completo</label>
              <input
                type="text"
                id="name"
                name="name"
                value={formData.name}
                onChange={handleInputChange}
                required
              />
            </div>
            
            <div className="checkout-page__form-group">
              <label htmlFor="email">Correo electrónico</label>
              <input
                type="email"
                id="email"
                name="email"
                value={formData.email}
                onChange={handleInputChange}
                required
              />
            </div>
            
            <div className="checkout-page__form-group">
              <label htmlFor="address">Dirección</label>
              <input
                type="text"
                id="address"
                name="address"
                value={formData.address}
                onChange={handleInputChange}
                required
              />
            </div>
            
            <div className="checkout-page__form-group">
              <label htmlFor="city">Ciudad</label>
              <input
                type="text"
                id="city"
                name="city"
                value={formData.city}
                onChange={handleInputChange}
                required
              />
            </div>
          </div>
          
          <div className="checkout-page__section">
            <h3>Información de Pago</h3>
            
            <div className="checkout-page__form-group">
              <label htmlFor="cardNumber">Número de tarjeta</label>
              <input
                type="text"
                id="cardNumber"
                name="cardNumber"
                value={formData.cardNumber}
                onChange={handleInputChange}
                placeholder="1234 5678 9012 3456"
                required
              />
            </div>
            
            <div className="checkout-page__form-row">
              <div className="checkout-page__form-group">
                <label htmlFor="expiryDate">Fecha de expiración</label>
                <input
                  type="text"
                  id="expiryDate"
                  name="expiryDate"
                  value={formData.expiryDate}
                  onChange={handleInputChange}
                  placeholder="MM/AA"
                  required
                />
              </div>
              
              <div className="checkout-page__form-group">
                <label htmlFor="cvv">CVV</label>
                <input
                  type="text"
                  id="cvv"
                  name="cvv"
                  value={formData.cvv}
                  onChange={handleInputChange}
                  placeholder="123"
                  required
                />
              </div>
            </div>
          </div>
          
          <button type="submit" className="checkout-page__submit">
            Pagar ${getCartTotal().toFixed(2)}
          </button>
        </form>
        
        <div className="checkout-page__summary">
          <h3>Resumen del Pedido</h3>
          
          <div className="checkout-page__order-items">
            {cartItems.map(item => (
              <div key={item.id} className="checkout-page__order-item">
                <span>{item.name} x {item.quantity}</span>
                <span>${(item.price * item.quantity).toFixed(2)}</span>
              </div>
            ))}
          </div>
          
          <div className="checkout-page__total">
            <span>Total:</span>
            <span>${getCartTotal().toFixed(2)}</span>
          </div>
        </div>
      </div>
    </div>
  );
};

export default CheckoutPage;